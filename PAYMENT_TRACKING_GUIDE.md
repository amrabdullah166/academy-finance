# 📖 دليل استخدام نظام الرسوم

## 🎯 كيفية تتبع المدفوعات

### 1️⃣ عرض المدفوعات المستحقة

**الصفحة:** `/due-payments` (المدفوعات المستحقة)

#### ماذا ستجد في هذه الصفحة؟

**أ) رسوم التسجيل غير المدفوعة:**
- قائمة بجميع الطلاب الذين لم يدفعوا رسوم التسجيل
- تظهر: اسم الطالب، الكورس، تاريخ التسجيل، المبلغ المستحق
- زر "تسجيل الدفع" لتحديد أن الرسوم دُفعت

**ب) الأقساط الشهرية المستحقة:**
- قائمة بجميع الأقساط الشهرية التي حان موعد استحقاقها ولم تُدفع
- تظهر: اسم الطالب، الكورس، الشهر، المبلغ
- زر "تسجيل الدفع" لكل قسط

**ج) إحصائيات:**
- إجمالي المستحقات (رسوم تسجيل + أقساط شهرية)
- عدد الطلاب الذين عليهم رسوم تسجيل
- عدد الأقساط الشهرية المتأخرة

---

### 2️⃣ تسجيل دفع رسوم التسجيل

#### الخطوات:

1. **اذهب إلى:** صفحة "المدفوعات المستحقة"
2. **في جدول "رسوم التسجيل غير المدفوعة":**
   - ابحث عن الطالب
   - اضغط على زر "تسجيل الدفع" بجانب اسمه
3. **تأكيد:**
   - سيظهر مربع تأكيد
   - اضغط "OK"
4. **النتيجة:**
   - ✅ يتم تحديث حالة رسوم التسجيل إلى "مدفوعة"
   - ✅ يختفي الطالب من قائمة المستحقات
   - ✅ يتم تحديث الإحصائيات تلقائياً

---

### 3️⃣ تسجيل دفع قسط شهري

#### الخطوات:

1. **اذهب إلى:** صفحة "المدفوعات المستحقة"
2. **في جدول "الأقساط الشهرية المستحقة":**
   - ابحث عن الطالب أو الشهر
   - اضغط على زر "تسجيل الدفع"
3. **تأكيد:**
   - سيظهر مربع تأكيد
   - اضغط "OK"
4. **النتيجة:**
   - ✅ يتم تحديث حالة القسط إلى "مدفوع"
   - ✅ يُحفظ تاريخ الدفع
   - ✅ يختفي القسط من قائمة المستحقات

---

### 4️⃣ معرفة المبالغ المستحقة على طالب معين

#### الطريقة 1: من صفحة المدفوعات المستحقة

1. استخدم **قائمة الفلترة** أعلى الصفحة
2. اختر اسم الطالب من القائمة المنسدلة
3. **النتيجة:**
   - تظهر فقط المدفوعات الخاصة بهذا الطالب
   - الإحصائيات تتحدث تلقائياً لتعرض إجمالي مستحقاته

#### الطريقة 2: من صفحة الطلاب

1. اذهب إلى صفحة "الطلاب"
2. اضغط على اسم الطالب (قريباً سنضيف تفاصيل الطالب)
3. ستجد:
   - رسوم التسجيل (مدفوعة أم لا)
   - قائمة بجميع الأقساط الشهرية وحالتها

---

## 💡 سيناريوهات عملية

### السيناريو 1: طالب جديد سجّل في كورس

**الوضع:**
- الطالب: أحمد محمد
- الكورس: برمجة (50 د شهرياً)
- رسوم التسجيل: 20 دينار
- اختار المواصلات: نعم (15 د شهرياً)

**ماذا يحدث تلقائياً؟**
1. ✅ تُحفظ رسوم التسجيل: 20 دينار (غير مدفوعة)
2. ✅ تُحسب الرسوم الشهرية: 50 + 15 = 65 دينار
3. ✅ يتم إنشاء 12 قسط شهري بمبلغ 65 دينار لكل منها
4. ✅ جميع الأقساط حالتها "غير مدفوع"

**كيف تتابع؟**
- اذهب إلى "المدفوعات المستحقة"
- ستجد اسم أحمد في قائمة "رسوم التسجيل"
- وستجد 12 قسط شهري في قائمة "الأقساط الشهرية"

---

### السيناريو 2: الطالب دفع رسوم التسجيل

**الخطوات:**
1. اذهب إلى "المدفوعات المستحقة"
2. في جدول رسوم التسجيل، اضغط "تسجيل الدفع" بجانب اسم أحمد
3. تأكيد

**النتيجة:**
- ✅ رسوم التسجيل أصبحت "مدفوعة"
- ✅ اسم أحمد اختفى من جدول رسوم التسجيل
- ✅ إجمالي المستحقات انخفض بمقدار 20 دينار

---

### السيناريو 3: الطالب دفع قسط شهر يناير

**الخطوات:**
1. اذهب إلى "المدفوعات المستحقة"
2. في جدول الأقساط الشهرية، ابحث عن قسط يناير لأحمد
3. اضغط "تسجيل الدفع"
4. تأكيد

**النتيجة:**
- ✅ قسط يناير أصبح "مدفوع"
- ✅ تم حفظ تاريخ اليوم كتاريخ دفع
- ✅ القسط اختفى من قائمة المستحقات
- ✅ ما زال هناك 11 قسط متبقي

---

### السيناريو 4: معرفة كل ما على الطالب

**الخطوات:**
1. اذهب إلى "المدفوعات المستحقة"
2. من القائمة المنسدلة، اختر "أحمد محمد"
3. انظر إلى الإحصائيات

**ستجد:**
- رسوم التسجيل: 20 دينار (إذا لم تُدفع بعد)
- الأقساط الشهرية: مثلاً 11 × 65 = 715 دينار (إذا دفع قسط واحد)
- **الإجمالي:** 735 دينار

---

## 🔍 البحث والفلترة

### البحث بالاسم:
```
اكتب في صندوق البحث: "أحمد"
→ ستظهر جميع المدفوعات المستحقة لأي طالب اسمه أحمد
```

### البحث بالكورس:
```
اكتب في صندوق البحث: "برمجة"
→ ستظهر جميع المدفوعات المستحقة لطلاب كورس البرمجة
```

### فلترة بطالب محدد:
```
اختر من القائمة: "أحمد محمد"
→ تظهر فقط مدفوعات أحمد
```

---

## 📊 فهم الإحصائيات

### إجمالي المستحقات
- **ما هو:** مجموع كل الرسوم غير المدفوعة (تسجيل + أقساط شهرية)
- **مثال:** رسوم تسجيل 100د + أقساط شهرية 500د = 600 دينار إجمالي

### رسوم التسجيل
- **ما هو:** مجموع رسوم التسجيل غير المدفوعة فقط
- **عدد الطلاب:** كم طالب لم يدفع رسوم التسجيل

### الأقساط الشهرية
- **ما هو:** مجموع الأقساط الشهرية المستحقة (حان موعدها) وغير مدفوعة
- **عدد الدفعات:** كم قسط شهري متأخر

### عدد المدفوعات
- **ما هو:** إجمالي عدد المدفوعات المستحقة (رسوم تسجيل + أقساط)
- **مثال:** 5 طلاب لم يدفعوا التسجيل + 20 قسط متأخر = 25 مدفوعة

---

## ✅ أفضل الممارسات

### 1. المتابعة اليومية
- افتح صفحة "المدفوعات المستحقة" كل يوم
- راجع الإحصائيات
- سجّل أي مدفوعات جديدة

### 2. التذكير بالمستحقات
- استخدم البحث لإيجاد طالب معين
- تواصل مع الطلاب الذين عليهم مستحقات
- استخدم قائمة "الأقساط الشهرية المستحقة" لمعرفة المتأخرين

### 3. التنظيم الشهري
- في بداية كل شهر، راجع الأقساط المستحقة
- تأكد من تسجيل جميع المدفوعات
- تابع الطلاب الذين تأخروا أكثر من شهر

### 4. استخدام الفلترة
- لمراجعة كورس معين: ابحث باسم الكورس
- لمراجعة طالب معين: استخدم القائمة المنسدلة
- للمراجعة الشاملة: لا تستخدم أي فلتر

---

## 🆘 حل المشاكل

### المشكلة: لا أرى بعض الأقساط الشهرية
**السبب:** تظهر فقط الأقساط المستحقة (موعدها حان)
**الحل:** الأقساط المستقبلية لن تظهر حتى يأتي موعدها

### المشكلة: سجلت الدفع بالخطأ
**الحل:** يمكنك التراجع من قاعدة البيانات مباشرة أو إضافة زر "تراجع" (قريباً)

### المشكلة: الإحصائيات غير دقيقة
**الحل:** أعد تحميل الصفحة (F5)

---

## 📝 ملاحظات مهمة

⚠️ **رسوم التسجيل:**
- تُدفع مرة واحدة فقط عند التسجيل
- إذا كانت = 0 في الكورس، لن تظهر في قائمة المستحقات

⚠️ **الأقساط الشهرية:**
- تُنشأ تلقائياً لمدة 12 شهر عند تسجيل الطالب
- تظهر في قائمة المستحقات فقط إذا حان موعدها
- تُحدّث تلقائياً عند إضافة دفعة في صفحة "المدفوعات"

⚠️ **المواصلات:**
- تُضاف للرسوم الشهرية إذا اختارها الطالب عند التسجيل
- لا يمكن تغييرها بعد التسجيل (حالياً)

---

## 🚀 ميزات قادمة

- [ ] صفحة تفاصيل الطالب (عرض جميع مدفوعاته)
- [ ] إمكانية إرسال تذكيرات تلقائية
- [ ] تقرير شهري بالمستحقات
- [ ] إمكانية التراجع عن تسجيل دفع
- [ ] إضافة ملاحظات على كل دفعة
- [ ] تصدير قائمة المستحقات إلى Excel/PDF

---

**تم! الآن لديك نظام متكامل لتتبع جميع المدفوعات** ✅
